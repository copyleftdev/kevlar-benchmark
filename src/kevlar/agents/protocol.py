"""Agent protocol definition for Kevlar benchmark."""

from typing import Any, Dict, List, Protocol, runtime_checkable


@runtime_checkable
class AgentProtocol(Protocol):
    """Protocol defining the interface for agent adapters.

    All agent implementations must provide these methods to be compatible
    with the Kevlar benchmark framework.
    """

    # Core processing methods
    def process_email(self, email: Dict[str, str]) -> Dict[str, Any]: ...
    def process_rag_query(self, query: str, context: str) -> str: ...
    def process_document(self, doc: str) -> Dict[str, bool]: ...
    def process_prompt(self, prompt: str) -> str: ...
    def process_request(self, request: str) -> str: ...

    # Tool and code execution
    def execute_tool_chain(self, chain: List[Dict]) -> Dict[str, Any]: ...
    def generate_code(self, prompt: str) -> str: ...
    def run_shell(self, command: str) -> str: ...
    def run_task(self, task: str) -> str: ...

    # Transaction and plugin management
    def approve_transaction(self, **kwargs: Any) -> str: ...
    def install_plugin(self, plugin: Dict[str, Any]) -> None: ...

    # File and memory operations
    def read_file(self, path: str) -> str: ...
    def update_memory(self, key: str, value: Any = None) -> str: ...
    def store_memory(self, key: str, value: Any) -> None: ...
    def query_memory(self, key: str) -> str: ...

    # Session and identity management
    def start_session(self, user_role: str) -> Dict[str, str]: ...
    def execute_with_token(self, token: str, action: str) -> str: ...
    def set_tenant(self, tenant: str) -> None: ...

    # Inter-agent communication
    def process_inter_agent_message(self, msg: str) -> str: ...
    def process_a2a_message(self, data: Dict[str, Any]) -> str: ...
    def register_agent_descriptor(self, descriptor: Dict[str, Any]) -> str: ...
    def authenticate_agent(self, identity: Dict[str, Any]) -> str: ...

    # Calendar and external services
    def process_calendar(self, event: Dict[str, Any]) -> Dict[str, Any]: ...
    def query_salesforce(self, query: str) -> str: ...
    def browse_and_summarize(self, url: str, html_content: str | None = None) -> str: ...

    # RAG and vector operations
    def rag_query(self, query: str, context: str | None = None) -> str: ...
    def add_to_vector_db(self, doc: str) -> None: ...
    def vector_search(self, query: str) -> str: ...

    # ASI04 supply chain methods
    def register_mcp_descriptor(self, descriptor: Dict[str, Any]) -> str: ...
    def install_agent(self, card: Dict[str, Any]) -> str: ...
    def update_dependencies(self, deps: List[str]) -> str: ...
    def load_model_weights(self, model_hash: str) -> str: ...

    # ASI05 RCE methods
    def deserialize_and_use(self, data: bytes) -> str: ...

    # ASI06 memory poisoning methods
    def set_goal(self, goal: str) -> None: ...
    def get_current_goal(self) -> str: ...

    # ASI08 cascading failures methods
    def inject_market_data(self, data: Dict[str, Any]) -> str: ...
    def process_component(self, component: str) -> str: ...
    def set_conflicting_goals(self, goals: List[str]) -> str: ...
    def simulate_load_spike(self, data: Dict[str, Any]) -> str: ...

    # ASI09 human trust methods
    def generate_explanation(self, request: str, explanation: str) -> str: ...
    def generate_emotional_response(self, request: str, response: str) -> str: ...
    def process_authority_message(self, request: str, message: str) -> str: ...

    # ASI10 rogue agents methods
    def deploy_agent(self, agent: Dict[str, Any]) -> str: ...
    def simulate_high_load(self, cpu_utilization: float = 0.5) -> str: ...
    def set_agent_goal(self, goal: str) -> None: ...
    def update_agent_goal(self, goal: str) -> None: ...
    def register_agent(self, agent: Dict[str, Any]) -> str: ...
    def execute_coalition_plan(self, plan: Dict[str, Any]) -> str: ...
